{% extends 'base.html' %} {% block title %} –ù–∞–π—Ç–∏ –∫–≤–∞—Ä—Ç–∏—Ä—É –ë–∏—à–∫–µ–∫{% endblock %}
{% block content %}

{% load static %}




<style>
*{
scroll-behavior:smooth;
}

.heye {
    position: relative;
}
li{
list-style:none;}


.heye::before{
z-index:1000;
position:absolute;
content:'‚ñº';
bottom: 0px;
padding:10px 40px 0px 0px;
font-size:16px;
width:100%;
text-align:center;
font-weight:bold;
color:var(--gold);
box-shadow:0 0 50px white;
background: linear-gradient(to top, rgba(255, 255, 255, 1) 50%, rgba(255, 255, 255, 0.3));
}
.heye::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index:100;
    box-shadow: inset 0 -5px 15px 0px #fff;
    pointer-events: none; /* Ensures the shadow doesn't interfere with content interaction */
}


       .parent {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          grid-template-rows: repeat(3, 1fr);
          grid-column-gap: 0px;
          grid-row-gap: 0px;
          width: 100%;
          height: 100%;
          margin: 10px; 
        }
        .div3 {
          /* box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px; */
          grid-area: 3 / 2 / 4 / 4;
          border-radius: 0 0 10px 10px;
          background-color: white;
          /* z-index: 1100; */
        }
        .div2 {
          grid-area: 1 / 1 / 3 / 4;
          /* box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px; */
          padding: 10px;
          border-radius: 10px 10px 0 10px;
          background: white;
        }
        .div1 {
          grid-area: 3 / 1 / 4 / 2;
          background-color: transparent transparent;
  
          /* background-color: 100%; */
          padding: 10px;
        }
        .div1 div img {
          width: 100%;
          height: 100%;
          border-radius: 100% !important;
          box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
        }
  
        .box {
          display: flex;
          align-items: start;
          /* background-color: black; */
          justify-content: start;
          flex-direction: column;
          color: black; /* Adjust text color for visibility */
          font-size: 16px; /* Adjust text size */
               padding:10px;
        }
  .theme-1 {
    display: flex !important;
    flex-direction: column !important;
    gap: 0px !important;
    border-radius: 10px !important;
    position: relative !important;
    padding:0px !important;
    background:transparent !important;
    box-shadow:none !important;
  }

  .theme-1 img {
    border-radius: 0px !important;
  }

  .theme-1 .price {
    position: absolute !important;
    top: 0% !important;
    background: var(--gold);
    right: 0px;
    padding: 6px;
    opacity: 0.9;
    transform: skew(-20deg);
  }

  .theme-1 .price div {
    transform: skew(20deg);
    color: black;
    /* here */
    color: white !important; 

  }

  .theme-1 .details {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    padding: 10px;
    background:white !important;
    border-radius: 0 0 10px 10px;
  }

  .theme-1 .details div {
    background: rgba(0, 0, 0, 0.9);
    padding: 4px;
    color: white;
  }
  .theme-1 .details p {
    padding: 2px 4px;
    font-size: 16px;
    font-weight:600;
  }

  .themek::after {
    content: "";
    position: absolute;
    width: 100%;
    height: 100%;
    background-color: inherit;
    clip-path: polygon(
      30% 0%,
      70% 0%,
      100% 30%,
      100% 70%,
      70% 100%,
      30% 100%,
      0% 70%,
      0% 30%
    );
  }

  .theme-button-1 {
    border-radius: 0px !important;
    background: rgba(0, 0, 0, 0.95) !important;
    color: white;
    padding: 8px 16px !important;
    position: relative;
    margin: 0px !important;
  }

  .theme-button-right-1 {
    border-radius: 0px !important;
    background: var(--gold);
    color: black;
    padding: 8px 16px !important;
    position: relative;
    margin: 0px !important;
  }

  .n-button {
    margin: 10px;
  }

  .theme-button-right-1::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 100%;
    border-width: 19px; /* Adjust size as needed */
    border-style: solid;
    border-color: transparent transparent transparent var(--gold); /* Adjust color and direction */
    transform: translateY(-50%);
  }

  .theme-button-1::before {
    content: "";
    position: absolute;
    top: 50%;
    right: 100%;
    border-width: 19px; /* Adjust size as needed */
    border-style: solid;
    border-color: transparent rgba(0, 0, 0, 0.95) transparent transparent; /* Adjust color and direction */
    transform: translateY(-50%);
  }

  .page-nav ul {
    margin: 20px;
    gap: 0px !important;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }
</style>

<style>
  .tag-filter .he {
    display: flex;
    width: 100;
    align-items: flex-end;
    flex-direction: row;
    justify-content: end;
  }

  .horizontal-div {
    overflow: auto;
    scrollbar-width: none; /* For Firefox */
  }

  .horizontal-div::-webkit-scrollbar {
    display: none; /* For Chrome, Safari, and Edge */
  }
</style>

<style>
  .filter-bar {
    display: grid !important;
    grid-template-columns: repeat(20, 1fr) !important;
    gap: 4px !important;
    overflow-x: auto !important;
    scroll-snap-type: x mandatory !important;
  }

  .filter-option {
    scroll-snap-align: start !important;
  }
    .slider {
            width: 100%;
            max-width: 600px;
            overflow-x: scroll;
            scroll-snap-type: x mandatory;
            display: flex;
            gap: 20px;
            -webkit-overflow-scrolling: touch;
        }

        .slide {
            flex: 0 0 auto;         
            width: 100%;
            aspect-ratio: 1/1;
            scroll-snap-align: center;
            background-color: transparent;
            display: flex;
            justify-content: center;
            align-items: center;
            padding:0px !important;
        }

        .slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

</style>
<div id="top"></div>
<form
  style=" margin-top: 64px !important; padding-top:0px;padding-left:0px; background-color: white;"
  class="tag-filter"
  method="GET"
  action="{% url 'home' %}"
  class="filter-form horizjontal-div"
>
  <div style="margin-left: 20px !important; margin-top: 0px !important;"  class="filter-bar horizontal-div">
    {% for tag in tags.all %} {% if not tag.is_admins %}
    <div  class="filter-option">
      <input
        type="checkbox"
        id="{{ tag.id }}"
        name="filter"
        value="{{ tag.id }}"
        class="filter-input"
      />
      <label
        style="
font-size:16px;
font-weight:light;
 border-radius:8px; color: gray;"

        for="{{ tag.id }}" class="filter-label"> {{ tag.name }}</label>
    </div>
    {% endif %} {% endfor %}
  </div>
  <div class="text-center">
    <div class="he">
      <a
        style="outline:1px solid gray ;color: gray; background: transparent"
        href="{% url 'home' %}"
        type="submit"
        class="n-button"
        >–°–±—Ä–æ—Å–∏—Ç—å</a
      >
      <button type="submit" class="n-button">–ù–∞–π—Ç–∏</button>
    </div>
  </div>
</form>

<div class="container">
  
  <div class="row">  
    <div style=" grid-row: 1/-1 ; width: 100%; display: flex; align-items: center;justify-content: center; gap: 20px;">
      <div style="display: flex; flex-direction: column; justify-content: space-between;">
        <div id="nav-bar" style="width: 100%; height: 6px; background-color: rgb(0, 0, 0); border-radius: 0px 0px 10px 10px;"></div>
        <a id="nav-link" style="all: unset; padding: 20px; cursor: pointer;" href="/">–õ–µ–Ω—Ç–∞</a>
    </div>
    <div style="display: flex; flex-direction: column; justify-content: space-between;">
        <div id="liked-bar" style="width: 100%; height: 6px; background-color: transparent; border-radius: 0px 0px 10px 10px;"></div>
        <button id="liked-btn" onclick="openLikedPosts()" style="all: unset; padding: 20px; cursor: pointer;">–õ–∞–π–Ω—É—Ç—ã–µ</button>
    </div>


      <script>
        function updateLikedCount() {
            const likedItems = JSON.parse(localStorage.getItem("likedItems")) || [];
            document.getElementById("liked-btn").textContent = `–õ–∞–π–Ω—É—Ç—ã–µ (${likedItems.length})`;
        }
      
        updateLikedCount(); // Call function on page load
      </script>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.has("posts")) {
        document.getElementById("liked-bar").style.backgroundColor = "black";
        document.getElementById("nav-bar").style.backgroundColor = "transparent";
    } else {
        document.getElementById("nav-bar").style.backgroundColor = "black";
        document.getElementById("liked-bar").style.backgroundColor = "transparent";
    }
</script>
      
    </div>
    
    <div class="listing-grid">
  
<!--  <img
    style="
      position: fixed;
      top: 0px;
      opacity: 0.06;
      z-index: -1;
      height: 100vh;
      object-fit: cover;
    "
    src="https://nobox.kg/static/bg.jpg"
  />
-->
      {% for post in posts %}
      <div  class="theme-1 listing">

      <a href="{% url 'post_detail' post.id %}" class="slider">
    <div style="position:relative"  class="slide">
    
          <img style="margin:0px !important; border-radius:10px !important;"  src="/media/{{ post.picture }}" alt="Room" />
          <!-- <img style="margin:0px !important; border-radius:10px !important;"  src="https://images.unsplash.com/photo-1729779525818-a76a544f252d?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxmZWF0dXJlZC1waG90b3MtZmVlZHwxN3x8fGVufDB8fHx8fA%3D%3D" alt="Room" /> -->
<div style="border-radius:0 0 10px 10px; flex-wrap:wrap;position:absolute;display:flex; gap:10px;padding:20px; bottom:0px;left:0;color:white;">       
   {% for tag in post.tags.all %}
         <p style="font-size:24px;font-weight:bold;">{{ tag }}|</p>
   {% endfor %}
</div>	
    </div>
    <div class="slide">
  
      <div class="parent">
        <div class="box div1">
          <div style="position: relative">
            <img 
  src="{% static 'profile_icon.jpg' %}" 
  alt=""
/>

            <div
              style="
                position: absolute;
                width: 10px;
                height: 10px;
                top: 0px;
                right: 0px;
                border-radius: 100%;
                background-color: white;
                box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
              "
            ></div>
          </div>
        </div>
<pre class="box div2 heye" style=" padding:20px !important;
 color:rgba(0,0,0,0.8); font-size:15px;
 background: linear-gradient(to top, rgba(255,255,255,1) 0%, rgba(255,255,255,0) 30%),
             white; /* Gradient overlay */
 white-space: pre-wrap;
 overflow: hidden;
 text-overflow: ellipsis;
 position: relative;
">
   {{ post.description|slice:"0:-25" }}...
</pre>	
        <div class="box div3">
          <p style="font-size: 16px; font-weight: 600; color:rgba(0,0,0,0.9);">–° —É–≤–∞–∂–µ–Ω–∏–µ–º, –†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—å</p>
          <br />
          <small
            >–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: <br/>{{ post.time_since_posted }}</small
          >
         
        </div>
      </div>
       
<!--       <pre style="white-space:pre-wrap; padding:4px; font-size:16px;font:inherit;"><button style="all:unset;" href="/post/ {{ post.id }}">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button> </pre> -->
   
  {% if post.price != 7777 %}






<div class="price">
    <!-- Post content here -->




          <div id="price">
            {% if post.price == 0%} –î–æ–≥–æ–≤–æ—Ä {% else %} {{post.price}} 
            {% endif %}
          </div>
        </div>
        {% endif %}

</div>
</a>

{% if user.is_premium %}
    <button style="font-family: 'Noto Color Emoji', sans-serif !important; z-index: 1000; all: unset; cursor: pointer; background: #000000; padding: 10px 20px; border-radius: 10px; background-color: var(--gold); color: black;  margin-left: auto; margin-top: 10px;" 
        onclick=" window.location.href='tel:+996700000000';">
        ‚Üë –ü–æ–∑–≤–æ–Ω–∏—Ç—å üìû
    </button>
{% endif %}

</div>

  {% endfor %}
  <!-- Your post display logic here -->
  <script>
    window.onload = function () {
      // Function to check and set filter checkboxes based on URL parameters
      function checkFilterCheckboxes() {
        const urlParams = new URLSearchParams(window.location.search);
        const filters = urlParams.getAll("filter");

        filters.forEach((filter) => {
          const checkbox = document.querySelector(
            `input[name="filter"][value="${filter}"]`
          );
          if (checkbox) {
            checkbox.checked = true;
          }
        });
      }

      // Function to scroll right and then back
      function scrollToRight() {
        return new Promise((resolve) => {
          const div = document.querySelector(".horizontal-div");
          if (div) {
            div.scrollLeft = div.scrollWidth / 5;
            setTimeout(resolve, 100); // Adjust timeout as needed
          } else {
            resolve(); // No div to scroll, resolve immediately
          }
        });
      }

      function scrollBack() {
        const div = document.querySelector(".horizontal-div");
        if (div) {
          div.scrollTo({ left: 0, behavior: "smooth" });
        }
      }

      // Execute both functions
      checkFilterCheckboxes();
      scrollToRight().then(scrollBack);

      var currency = "—Å–æ–º";
      var priceElements = document.querySelectorAll("#price");
      priceElements.forEach((priceElement) => {
        var price = parseFloat(priceElement.textContent);
        if (price) {
          priceElement.textContent =
            price.toLocaleString("en-US").replace(/,/g, " ") + currency;
        }
      });
    };
  </script>
  <nav id="bottom" class="page-nav" aria-label="Page navigation">


    <ul style="margin:auto;" class="pagination justify-content-center">

      {% if page_obj.has_previous %}

      <li style=" display:inline; outline:1px solid gray ;color: gray; background: transparent; margin-right:16px;" class=" n-button">
        <a style="display:inline"
          class="page-link"
          href="?{% with filter_params as params %}{{ params }}{% if params %}&{% endif %}page={{ page_obj.previous_page_number }}{% endwith %}"
          aria-label="Previous"
        >
          <span aria-hidden="true">&laquo; –ü—Ä–µ–¥—ã–¥—É—â–∏–µ</span>
        </a>
      </li>




<!--      <div style="font-size: 18px; font-weight: bold">|</div>-->
      {% endif %} {% if page_obj.has_next %}
      <li class=" n-button">
        <a
          style="display:inline"
          href="?{% with filter_params as params %}{{ params }}{% if params %}&{% endif %}page={{ page_obj.next_page_number }}{% endwith %}"
          aria-label="Next"
        >
          <span class="" aria-hidden="true">–°–ª–µ–¥—É—é—â–∏–µ &raquo;</span>
        </a>
      </li>


<!--
      <div style="font-size: 18px; font-weight: bold">|</div>
      <div style="font-size: 18px; font-weight: bold">/\</div>
-->
      {% endif %}
    </ul>
  </nav>


</div>
</div>

  {% endblock %}
