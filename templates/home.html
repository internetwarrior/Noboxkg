
{% extends 'base.html' %}
{% block title %}
Найти квартиру Бишкек{% endblock %}
{% block content %}


<style>
.tag-filter .he{
display:flex;
width:100;
align-items:flex-end;
flex-direction:row;
justify-content:end;
}

.horizontal-div {
    overflow: auto;
    scrollbar-width: none; /* For Firefox */
}

.horizontal-div::-webkit-scrollbar {
    display: none; /* For Chrome, Safari, and Edge */
}
</style>

<script>


window.onload = function() {
    function checkFilterCheckboxes() {
        const urlParams = new URLSearchParams(window.location.search);
        const filters = urlParams.getAll('filter');

        filters.forEach(filter => {
            const checkbox = document.querySelector(`input[name="filter"][value="${filter}"]`);
            if (checkbox) {
                checkbox.checked = true;
            }
        });
    }

    checkFilterCheckboxes();
};


function scrollToRight() {
    return new Promise((resolve) => {
        const div = document.querySelector('.horizontal-div');
        div.scrollLeft = div.scrollWidth/5;
        setTimeout(resolve, 100); // Adjust timeout as needed
    });
}

function scrollBack() {
    const div = document.querySelector('.horizontal-div');
    div.scrollTo({ left: 0, behavior: 'smooth' });
}

window.onload = () => {
    scrollToRight().then(scrollBack);
};
</script>


<style>
.filter-bar {
    display: grid !important;
    grid-template-columns: repeat(5, 1fr) !important;
    gap: 4px !important;
    overflow-x: auto !important;
    scroll-snap-type: x mandatory !important;
}

.filter-option {
    scroll-snap-align: start !important;
}
</style>


<form style=""class="tag-filter" method="GET" action="{% url 'home' %}" class="filter-form horizjontal-div">
       <div class="filter-bar horizontal-div">
        {% for tag in tags.all %}
        <div class="filter-option">
            <input type="checkbox" id="{{ tag.id }}" name="filter" value="{{ tag.id }}" 
                class="filter-input" 
                >
            <label for="{{ tag.id }}" class="filter-label"> {{ tag.name }}</label>
        </div>
        {% endfor %}
    </div>
    <div class="text-center">
    <div class="he">
     <a style="outline:1px solid gray; color:gray;background:transparent;" href="{% url 'home' %}" type="submit" class="n-button">Сбросить</a>
      <button type="submit" class="n-button">Найти</button>
    </div>
       
        
        
    </div>
</form>
<div class="container">

      
        <div class="row">
     
            <div class="listing-grid">
                  {% for post in posts %}
        <a href="{% url 'post_detail' post.id %}" class="listing">
            <img src="media/{{ post.picture }}" alt="Room">
            <div class="details">
            {% for tag in post.tags.all %}
                                   {{ tag.name }} |
            {% endfor %}
            </div>
            
            <div class="price">

               <div>{% if post.price == 0%}
    Договор
    {% else %}
    {{ post.price }}сом
    
    {% endif %}</div>
             </div>
             
                 
                 </a>
           
               {% endfor %}
          
                   
                    

             
               </div>        
                                   
    </div>
    
                        {% for post in posts %}
    <!-- Your post display logic here -->
{% endfor %}

<nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
        {% if page_obj.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?{% with filter_params as params %}{{ params }}{% if params %}&{% endif %}page={{ page_obj.previous_page_number }}{% endwith %}" aria-label="Previous">
                    <span style="opacity:0.5" class="n-button" aria-hidden="true">&laquo; Предыдущие</span>
                </a>
            </li>
        {% endif %}

        {% if page_obj.has_next %}
            <li class="page-item">
                <a class="page-link" href="?{% with filter_params as params %}{{ params }}{% if params %}&{% endif %}page={{ page_obj.next_page_number }}{% endwith %}" aria-label="Next">
                    <span class="n-button" aria-hidden="true">Следующие &raquo;</span>
                </a>
            </li>
        {% endif %}
    </ul>
</nav>




{% endblock %}
